## 現場Rails Chapter03-02
## 「タスク管理アプリケーションを作ろう」 「タスクモデルを作成する」
---

<BR><BR>

### タスクモデルの作成を始めるにあたって
---

全体的な設計や下準備の後、まず機能に関するモデル（MVCでいうところのC)を用意するのが一般的とのこと。  
現場railsに従って「タスクモデル」の作成から始める。  

「タスクモデル」・・・？？？

タスク管理を行う部分での基本となる処理機能を作成する。。。  
そこではデータベースも取り扱う。。。そんな感じだろうか。。。  

モデルは、以下の２つの要素から主に構成される。  
1. モデルに対応するRubyのクラス
2. モデルに対応するデータベースのテーブル  

なお、モデルのクラス名とデータベースのテーブル名には命名の規約があるとのこと。  
[Qiita：Railsにおける命名規則](https://qiita.com/gakkie/items/3afcd505c786364aa5fa)  

<br>

> |名称|例|解説|
> |:--:|:--:|:--:|
> |モデル名|cancel reason|
> |モデルクラス名|CancelReason|先頭大文字・キャメル・単数形|
> |ファイル名|cancel_reason.rb|先頭小文字・スネーク・単数形|
> |テーブル名|cancel_reasons|先頭小文字・スネーク・複数形|

<br>

これが「設定より規約を重視する（Convention over Configuration、CoC）」というRailsの理念か！  

<br>

### タスクモデルの属性を設計する
---

タスクモデルについて、以下の５つの属性が必要であると既に決定をしています。
1. ID
2. 名称
3. 詳しい説明
4. 登録日時
5. 更新日時

1, 4, 5 については、既にRails側で自動的に用意している属性なので、  
「2.名称」「3.詳しい説明」について検討する。  

- 属性名・カラム名
- データ型
- NULLを許可するか
- デフォルト値

<br>

### タスクモデルのひな形を作成する
---

検討終了後、rails g のコマンドを使い、タスクモデルのひな形を作成する。
コマンドは下記のとおり。

```
# モデル名 = Task
# 第一属性名 = name、データ型 = string
# 第二属性名 = description、データ型 = text

$ bin/rails g model Task name:string description:text
=> Running via Spring preloader in process 31810
      invoke  active_record
      # マイグレーションファイル
      create    db/migrate/20200506094134_create_tasks.rb
      # モデルクラスのソースコード
      create    app/models/task.rb
      invoke    test_unit
      # モデルの自動テスト
      create      test/models/task_test.rb
      # モデルの自動テストで使うfixtureファイル
      create      test/fixtures/tasks.yml
```

<br>

### マイグレーションでデータベースにテーブルを追加
---

Railsでテーブルを追加するには、マイグレーションという仕組みを使う。  

マイグレーションファイルは、データベーススキーマ（テーブル構造など）への変更履歴を保存している。
この履歴が保存されていることで、スキーマの歴史を順を追って最新にしたり、１ヶ月前の状態に戻すことができる。  

おそらく、gitとかなり近いような仕組みで動いているのだろう。  

マイグレーションファイルを適用するには、 rails db:migrate コマンドを使用する。  